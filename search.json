[{"path":"https://cidm-ph.github.io/phylepic/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2024 Western Sydney Local Health District, NSW Health Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://cidm-ph.github.io/phylepic/articles/phylepic.html","id":"preparing-the-data","dir":"Articles","previous_headings":"","what":"Preparing the data","title":"phylepic charts: combining phylogenetic trees with epidemic curves","text":"example uses real tree foodborne enteric pathogen. tree loaded Newick file using ape package:  tree comes metadata manipulated illustration. metadata includes name collection date samples, whether environmental clinical isolates (known), label isolates assigned genomic cluster. read CSV file: requirements column corresponds tip labels tree (called name), one dates represented Date objects. ’ll also indicate two columns categorical data converting factors:","code":"tree <- read.tree(system.file(\"enteric.newick\", package = \"phylepic\")) plot(tree) metadata <- read.csv(system.file(\"enteric_metadata.csv\", package = \"phylepic\")) head(metadata) #>       name collection_date source  cluster #> 1 NSW-0004      2013-02-18   <NA>     <NA> #> 2 NSW-0020      2016-11-19   <NA>     <NA> #> 3 NSW-0029      2017-01-13   <NA>     <NA> #> 4 NSW-0042      2017-02-28   <NA>     <NA> #> 5 NSW-0051      2017-11-20   <NA> Clust-01 #> 6 NSW-0054      2017-12-23   <NA>     <NA> metadata <- mutate(   metadata,   across(c(source, cluster), factor),   collection_date = as.Date(collection_date) )"},{"path":"https://cidm-ph.github.io/phylepic/articles/phylepic.html","id":"basic-plotting","dir":"Articles","previous_headings":"","what":"Basic plotting","title":"phylepic charts: combining phylogenetic trees with epidemic curves","text":"start , can pull one clade tree make small plot:  phylepic() function joins tree metadata consistency checks. resulting phylepic object plot method guesses sensible defaults:  Metadata bars added factor columns metadata frame, different categorical colour scales. dates binned week give epidemic curve upper right. calendar panel lower right weekly binning can scan across tip tree follow epidemic curve find collection date.","code":"clade.parent <- ape::getMRCA(tree, c(\"NSW-0324\", \"NSW-0330\")) clade <- ape::extract.clade(tree, clade.parent) plot(clade) phylepic(clade, metadata, name, collection_date) |> plot() #> Warning: Computation failed in `stat_edge_elbow()`. #> Caused by error in `if (!data$circular[1] && n%%2 == 0) ...`: #> ! missing value where TRUE/FALSE needed #> Warning: Removed 1 row containing non-finite outside the scale range #> (`stat_week()`). #> Warning: Computation failed in `stat_edge_elbow()`. #> Caused by error in `if (!data$circular[1] && n%%2 == 0) ...`: #> ! missing value where TRUE/FALSE needed #> Warning: Removed 1 row containing non-finite outside the scale range #> (`stat_week()`)."},{"path":"https://cidm-ph.github.io/phylepic/articles/phylepic.html","id":"customising-the-plot","dir":"Articles","previous_headings":"","what":"Customising the plot","title":"phylepic charts: combining phylogenetic trees with epidemic curves","text":"Looking full dataset instead just single clade, default plot needs configuration useful:","code":"phydata <- phylepic(tree, metadata, name, collection_date)  plot(phydata) #> Warning: Removed 7 rows containing non-finite outside the scale range (`stat_week()`). #> Removed 7 rows containing non-finite outside the scale range (`stat_week()`)."},{"path":"https://cidm-ph.github.io/phylepic/articles/phylepic.html","id":"the-date-scale","dir":"Articles","previous_headings":"Customising the plot","what":"The date scale","title":"phylepic charts: combining phylogenetic trees with epidemic curves","text":"can choose first day week match local conventions: date range big type chart, want focus time period near outbreak clusters Clust-04 Clust-05. using scale_x_week, get conveniences able specify breaks (tick labels) intervals weeks: can also control relative heights two rows panels final grid using height.tree (choosing make 6 times height epidemic curve). date scale passed relevant panels:  Note dates outside chosen date limits drawn calendar triangles corresponding edge scale. rows missing date metadata, allows us distinguish visually. feature enabled default oob (bounds) argument scale_x_week.","code":"options(phylepic.week_start = \"Monday\") date_scale <- scale_x_week(   name = \"Date of sample collection\",   limits = as.Date(c(\"2023-08-14\", \"2023-11-15\")),   date_labels = \"%d %b\",   week_breaks = 4L,   week_minor_breaks = 2L ) plot(phydata, scale.date = date_scale, height.tree = 6) #> Warning: Removed 28 rows containing non-finite outside the scale range (`stat_week()`). #> Removed 28 rows containing non-finite outside the scale range (`stat_week()`)."},{"path":"https://cidm-ph.github.io/phylepic/articles/phylepic.html","id":"manipulating-the-tree","dir":"Articles","previous_headings":"Customising the plot","what":"Manipulating the tree","title":"phylepic charts: combining phylogenetic trees with epidemic curves","text":"nice represent genomic clusters using colours tree tips instead separate column metadata tiles, since genomic clusters based tree structure. tree drawn using ggraph dendrogram layout. order add new layer tip dots, need intercept ggraph plot ’s assembled final chart. Firstly, let’s manually define colour scale clusters can consistent panels: manipulate tree, use plot_tree, creates base plot can add new layers:  columns metadata frame available (tips) use ggraph’s aesthetic mappings. Next, ’ll want hide redundant coloured tiles describing cluster. , use plot_bars override default behaviour creating bar factor metadata frame. helper takes arguments form <column name> = <scale definition>:  plot.* argument normally given function called single parameter: phylepic object provided plot. function must produce ggplot object suitable aligning final chart. plot.bars , wanted override default options without adding new custom layers. common cases like can reduce boilerplate bit: plot_* helpers return function instead ggplot first parameter omitted.","code":"cluster_scale <- scale_colour_brewer(   # the name affects the legend title   name = \"Cluster\",   # these 3 parameters affect the colour choice   type = \"qual\",   palette = 2,   direction = -1,   # don't drop unused levels; we want consistency between panels   drop = FALSE,   # suppress the explicit NA entry in the legend; not all tips are in a cluster   na.translate = FALSE,   # we'll use this scale later for both fill and colour aesthetics   aesthetics = c(\"fill\", \"colour\"),   # make the dots on the legend bigger so we can see the colours   guide = guide_legend(override.aes = list(size = 5)) ) plot_tree(phydata) +   # `filter = leaf` in ggraph geoms means that they only draw the tips   ggraph::geom_node_point(aes(filter = leaf, colour = cluster), size = 2) +   cluster_scale #> Warning: Duplicated `override.aes` is ignored. #> Warning: Removed 11 rows containing missing values or values outside the scale range #> (`geom_point()`). plot(   phydata,   plot.tree = function(x) {     # this function will be called with x = phydata     plot_tree(x) +       ggraph::geom_node_point(aes(filter = leaf, colour = cluster), size = 2) +       cluster_scale   },   plot.bars = function(x) {     plot_bars(       x,       # 'source' is the name of the corresponding metadata column       source = scale_fill_hue(         name = \"Source\",         # this just changes the colours         h.start = 30,         # as above, we want to turn off drop and na.translate         drop = FALSE,         na.translate = FALSE       ),     )   },   scale.date = date_scale,   width.tree = 20,  # new: also specify the relative widths of the 4 columns:   width.date = 12,  #   width.legend = 4, #   height.tree = 6 ) #> Warning: Duplicated `override.aes` is ignored. #> Warning: Removed 28 rows containing non-finite outside the scale range #> (`stat_week()`). #> Warning: Duplicated `override.aes` is ignored. #> Warning: Removed 11 rows containing missing values or values outside the scale range #> (`geom_point()`). #> Warning: Removed 28 rows containing non-finite outside the scale range #> (`stat_week()`). plot(   phydata,   plot.bars = function(x) {     plot_bars(       x,       source = scale_fill_hue(...)     )   } )  # equivalent to the above plot(   phydata,   plot.bars = plot_bars(     source = scale_fill_hue(...),   ) )"},{"path":"https://cidm-ph.github.io/phylepic/articles/phylepic.html","id":"making-use-of-the-calendar-and-epidemic-curve","dir":"Articles","previous_headings":"Customising the plot","what":"Making use of the calendar and epidemic curve","title":"phylepic charts: combining phylogenetic trees with epidemic curves","text":"previous plot shows two clear genomic clusters associated concurrent outbreaks. make point clearly, like indicate two clusters epidemic curve (using colour scale). achieve , pass fill = cluster plot.epicurve plot.calendar panels:  cluster colour scales consistent across panels, legend guides automatically combined.","code":"plot(   phydata,   plot.tree = function(x) {     plot_tree(x) +       ggraph::geom_node_point(aes(filter = leaf, colour = cluster), size = 2) +       cluster_scale   },   plot.bars = plot_bars(     source = scale_fill_hue(       name = \"Source\", h.start = 30, drop = FALSE, na.translate = FALSE     ),   ),   plot.epicurve = plot_epicurve(fill = cluster),   plot.calendar = plot_calendar(     fill = cluster,     labels = \"%d\",   ),   scale.date = date_scale,   scale.fill = cluster_scale, # new: pass the scale to both panels   width.tree = 20,   width.date = 12,   width.legend = 4,   height.tree = 6 ) #> Warning: Duplicated `override.aes` is ignored. #> Duplicated `override.aes` is ignored. #> Warning: Removed 28 rows containing non-finite outside the scale range #> (`stat_week()`). #> Warning: Duplicated `override.aes` is ignored. #> Duplicated `override.aes` is ignored. #> Warning: Removed 11 rows containing missing values or values outside the scale range #> (`geom_point()`). #> Warning: Duplicated `override.aes` is ignored. #> Warning: Removed 28 rows containing non-finite outside the scale range #> (`stat_week()`). #> Warning: Duplicated `override.aes` is ignored. #> New names: #> • `fill` -> `fill...1` #> • `colour` -> `colour...4` #> • `fill` -> `fill...5` #> • `colour` -> `colour...6` #> Warning: Duplicated `override.aes` is ignored. #> New names: #> • `fill` -> `fill...7` #> • `colour` -> `colour...8` #> Warning: Duplicated `override.aes` is ignored."},{"path":"https://cidm-ph.github.io/phylepic/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Carl Suster. Author, maintainer. Western Sydney Local Health District, NSW Health. Copyright holder.","code":""},{"path":"https://cidm-ph.github.io/phylepic/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Suster CJE, Watt AE, Wang Q, Chen SC, Kok J, Sintchenko V (2024). “Combined visualization genomic epidemiological data outbreaks [Preprint].” medRxiv. doi:10.1101/2024.04.02.24305229, https://www.medrxiv.org/content/early/2024/04/03/2024.04.02.24305229.","code":"@Article{,   journal = {medRxiv},   title = {Combined visualization of genomic and epidemiological data for outbreaks [Preprint]},   author = {Carl J. E. Suster and Anne E. Watt and Qinning Wang and Sharon C.-A. Chen and Jen Kok and Vitali Sintchenko},   year = {2024},   doi = {10.1101/2024.04.02.24305229},   url = {https://www.medrxiv.org/content/early/2024/04/03/2024.04.02.24305229}, }"},{"path":"https://cidm-ph.github.io/phylepic/index.html","id":"phylepic","dir":"","previous_headings":"","what":"Combined Visualisation of Phylogenetic and Epidemiological Data","title":"Combined Visualisation of Phylogenetic and Epidemiological Data","text":"Phylepic contains tools visualisations useful genomic epidemiology pathogens, designed public health setting.","code":""},{"path":"https://cidm-ph.github.io/phylepic/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Combined Visualisation of Phylogenetic and Epidemiological Data","text":"can install phylepic like :","code":"# development version install.packages('phylepic', repos = c('https://cidmp-ph.r-universe.dev', 'https://cloud.r-project.org'))"},{"path":"https://cidm-ph.github.io/phylepic/index.html","id":"example","dir":"","previous_headings":"","what":"Example","title":"Combined Visualisation of Phylogenetic and Epidemiological Data","text":"example minimal phylepic chart. Refer package vignette complete example.","code":"library(ape) library(phylepic)  tree <- read.tree(text = \"((D:0.3,C:0.4):0.5,B:0.1,A:0.2);\") metadata <- data.frame(   ID = c(\"A\", \"B\", \"C\", \"D\"),   date = as.Date(c(\"2024-01-10\", \"2024-01-12\", \"2024-01-21\", \"2024-01-23\")),   country = factor(c(\"Australia\", \"Australia\", NA, \"New Zealand\")) )  phylepic(tree, metadata, ID, date) |> plot()"},{"path":"https://cidm-ph.github.io/phylepic/index.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Combined Visualisation of Phylogenetic and Epidemiological Data","text":"See citation(\"phylepic\"). Suster CJE, Watt AE, Wang Q, Chen SC, Kok J, Sintchenko V (2024). “Combined visualization genomic epidemiological data outbreaks [Preprint].” medRxiv. doi:10.1101/2024.04.02.24305229,","code":""},{"path":"https://cidm-ph.github.io/phylepic/reference/coord_tree.html","id":null,"dir":"Reference","previous_headings":"","what":"Cartesian coordinates with specialised grid for trees — coord_tree","title":"Cartesian coordinates with specialised grid for trees — coord_tree","text":"coord based default Cartesian coordinates, draws filled background addition normal grid lines. grid forced appear every integer value within scale's range.","code":""},{"path":"https://cidm-ph.github.io/phylepic/reference/coord_tree.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Cartesian coordinates with specialised grid for trees — coord_tree","text":"","code":"coord_tree(   xlim = NULL,   ylim = NULL,   expand = TRUE,   default = FALSE,   clip = \"on\" )"},{"path":"https://cidm-ph.github.io/phylepic/reference/coord_tree.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Cartesian coordinates with specialised grid for trees — coord_tree","text":"xlim, ylim, expand, default, clip See ggplot2::coord_cartesian()","code":""},{"path":"https://cidm-ph.github.io/phylepic/reference/coord_tree.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Cartesian coordinates with specialised grid for trees — coord_tree","text":"coord suitable adding plot","code":""},{"path":"https://cidm-ph.github.io/phylepic/reference/coord_tree.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Cartesian coordinates with specialised grid for trees — coord_tree","text":"appearance grid can controlled theme elements: phylepic.grid.bar filled grid (element_rect()). phylepic.grid.line grid line (element_line()). phylepic.grid.every grid frequency (integer). Default phylepic.grid.every.bar phylepic.grid.every.stripe phylepic.grid.every.bar grid bar frequency (integer). Defaults 2 give alternative striped background phylepic.grid.every.stripe grid bar frequency (integer). Defaults 1 every tip tree line","code":""},{"path":"https://cidm-ph.github.io/phylepic/reference/create_tree_layout.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a graph layout for plotting — create_tree_layout","title":"Create a graph layout for plotting — create_tree_layout","text":"lays graph using ggraph::create_layout() \"dendrogram\" layout, takes edge lengths tree, flips layout coordinates. plotting functions associated phylepic() expect graph laid using settings.","code":""},{"path":"https://cidm-ph.github.io/phylepic/reference/create_tree_layout.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a graph layout for plotting — create_tree_layout","text":"","code":"create_tree_layout(tree, tip_data = NULL)"},{"path":"https://cidm-ph.github.io/phylepic/reference/create_tree_layout.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a graph layout for plotting — create_tree_layout","text":"tree tree-like graph phylepic object. tip_data data frame tip metadata. must column called .phylepic.name values correspond names leaf nodes tree. NULL, tip data joined onto tree.","code":""},{"path":"https://cidm-ph.github.io/phylepic/reference/create_tree_layout.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a graph layout for plotting — create_tree_layout","text":"\"layout_ggraph\" object suitable plotting ggplot2::ggplot`.","code":""},{"path":"https://cidm-ph.github.io/phylepic/reference/drop.clade.html","id":null,"dir":"Reference","previous_headings":"","what":"Drop a clade from a phylogentic tree — drop.clade","title":"Drop a clade from a phylogentic tree — drop.clade","text":"drop.clade invokes ape::drop.tip() tips descendent specified node. convenient used alongside ape::getMRCA() drop clade defined recent common ancestor set tips, rather exhaustively specifying tips.","code":""},{"path":"https://cidm-ph.github.io/phylepic/reference/drop.clade.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Drop a clade from a phylogentic tree — drop.clade","text":"","code":"drop.clade(phy, node, root.edge = 0, collapse.singles = TRUE)"},{"path":"https://cidm-ph.github.io/phylepic/reference/drop.clade.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Drop a clade from a phylogentic tree — drop.clade","text":"phy object class \"phylo\". node number specifying parent node clade delete. root.edge, collapse.singles passed ape::drop.tip().","code":""},{"path":"https://cidm-ph.github.io/phylepic/reference/drop.clade.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Drop a clade from a phylogentic tree — drop.clade","text":"New phylo object chosen clade removed","code":""},{"path":"https://cidm-ph.github.io/phylepic/reference/drop.clade.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Drop a clade from a phylogentic tree — drop.clade","text":"","code":"library(\"ape\") data(bird.orders) plot(bird.orders)   # find the common ancestor of some tips mrca <- ape::getMRCA(bird.orders, c(\"Passeriformes\", \"Coliiformes\"))  # drop the clade descending from that ancestor plot(drop.clade(bird.orders, mrca))"},{"path":"https://cidm-ph.github.io/phylepic/reference/geom_calendar.html","id":null,"dir":"Reference","previous_headings":"","what":"Specialised tile geometry for calendar plots — GeomCalendar","title":"Specialised tile geometry for calendar plots — GeomCalendar","text":"geom behaves mostly ggplot2::geom_tile() additions. Firstly, label aesthetic supported draw text top tiles. Secondly, bounds values can drawn arrows edge scale (see details ).","code":""},{"path":"https://cidm-ph.github.io/phylepic/reference/geom_calendar.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Specialised tile geometry for calendar plots — GeomCalendar","text":"","code":"geom_calendar(   mapping = NULL,   data = NULL,   stat = \"identity\",   position = \"identity\",   ...,   linejoin = \"mitre\",   label_params = list(),   na.rm = FALSE,   show.legend = NA,   inherit.aes = TRUE )"},{"path":"https://cidm-ph.github.io/phylepic/reference/geom_calendar.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Specialised tile geometry for calendar plots — GeomCalendar","text":"mapping, data, stat, position, linejoin, na.rm, show.legend, inherit.aes, ... see ggplot2::geom_tile(). label_params additional parameters text labels present (see ggplot2::geom_text()).","code":""},{"path":"https://cidm-ph.github.io/phylepic/reference/geom_calendar.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Specialised tile geometry for calendar plots — GeomCalendar","text":"x values infinite (.e. -Inf Inf) normally dropped ggplot's layers. values survive stat processing, drawn geom_calendar() triangles respective edges scale. intended work scale configures use oob_infinite() bounds handling.","code":""},{"path":"https://cidm-ph.github.io/phylepic/reference/geom_node_text_filled.html","id":null,"dir":"Reference","previous_headings":"","what":"Annotate nodes with text and a background — geom_node_text_filled","title":"Annotate nodes with text and a background — geom_node_text_filled","text":"geom behaves like ggraph::geom_node_text() except also inserts white background behind text extending left margin. make sense horizontal dendrogram graph layout root node left.","code":""},{"path":"https://cidm-ph.github.io/phylepic/reference/geom_node_text_filled.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Annotate nodes with text and a background — geom_node_text_filled","text":"","code":"geom_node_text_filled(   mapping = NULL,   data = NULL,   position = \"identity\",   parse = FALSE,   check_overlap = FALSE,   show.legend = NA,   ... )"},{"path":"https://cidm-ph.github.io/phylepic/reference/geom_node_text_filled.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Annotate nodes with text and a background — geom_node_text_filled","text":"mapping, data, position, parse, check_overlap, show.legend, ... Arguments passed geom powers ggraph::geom_node_text(). Note additional arguments function repel supported .","code":""},{"path":"https://cidm-ph.github.io/phylepic/reference/geom_node_text_filled.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Annotate nodes with text and a background — geom_node_text_filled","text":"Layer draws text background grobs","code":""},{"path":"https://cidm-ph.github.io/phylepic/reference/geom_node_text_filled.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Annotate nodes with text and a background — geom_node_text_filled","text":"background covers part grid rendered coord layer. reason done part text instead separate layer access rendered dimensions text grobs.","code":""},{"path":"https://cidm-ph.github.io/phylepic/reference/oob.html","id":null,"dir":"Reference","previous_headings":"","what":"Out of bounds handling — oob_infinite","title":"Out of bounds handling — oob_infinite","text":"helper works way scales::oob_censor() similar. bounds values pushed positive negative infinity. useful builtin ggplot layers display warning drop rows infinite values required aesthetics. geom_calendar() however uses infinite values indicate bounds values explicitly plot.","code":""},{"path":"https://cidm-ph.github.io/phylepic/reference/oob.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Out of bounds handling — oob_infinite","text":"","code":"oob_infinite(x, range = c(0, 1))"},{"path":"https://cidm-ph.github.io/phylepic/reference/oob.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Out of bounds handling — oob_infinite","text":"x numeric vector values modify. range numeric vector length two giving minimum maximum limit desired output range respectively.","code":""},{"path":"https://cidm-ph.github.io/phylepic/reference/phylepic-package.html","id":null,"dir":"Reference","previous_headings":"","what":"phylepic: Combined Visualisation of Phylogenetic and Epidemiological Data — phylepic-package","title":"phylepic: Combined Visualisation of Phylogenetic and Epidemiological Data — phylepic-package","text":"collection utilities ggplot extensions assist visualisations genomic epidemiology. includes phylepic chart, visual combination phylogenetic tree matched epidemic curve. included ggplot expensions date axes binned week relevant applications epidemiology beyond.","code":""},{"path":[]},{"path":"https://cidm-ph.github.io/phylepic/reference/phylepic-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"phylepic: Combined Visualisation of Phylogenetic and Epidemiological Data — phylepic-package","text":"Maintainer: Carl Suster Carl.Suster@health.nsw.gov.au (ORCID) contributors: Western Sydney Local Health District, NSW Health [copyright holder]","code":""},{"path":"https://cidm-ph.github.io/phylepic/reference/phylepic.html","id":null,"dir":"Reference","previous_headings":"","what":"Combine metadata (a line list) with a phylogenetic tree — phylepic","title":"Combine metadata (a line list) with a phylogenetic tree — phylepic","text":"checks performed catch issues metadata tree tips match . columns metadata factors levels appear data dropped.","code":""},{"path":"https://cidm-ph.github.io/phylepic/reference/phylepic.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Combine metadata (a line list) with a phylogenetic tree — phylepic","text":"","code":"phylepic(   tree,   metadata,   name,   date,   unmatched_tips = c(\"error\", \"drop\", \"keep\") )"},{"path":"https://cidm-ph.github.io/phylepic/reference/phylepic.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Combine metadata (a line list) with a phylogenetic tree — phylepic","text":"tree object convertible tbl_graph. usually \"phylo\" object, see tidygraph::tbl_graph details. metadata data frame. name Column metadata corresponds tree's tip labels (tidy-eval). date Column metadata contains date data (class \"Date\") tips (tidy-eval). unmatched_tips Action take tree contains tip labels appear name. \"error\" aborts error message, \"drop\" drops unmatched tips tree, \"keep\".","code":""},{"path":"https://cidm-ph.github.io/phylepic/reference/phylepic.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Combine metadata (a line list) with a phylogenetic tree — phylepic","text":"object class \"phylepic\".","code":""},{"path":"https://cidm-ph.github.io/phylepic/reference/phylepic.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Combine metadata (a line list) with a phylogenetic tree — phylepic","text":"reduce surprises matching metadata tree, default error occurs tree tips associated metadata. hand, expected metadata might contain rows correspond tips tree. often means factor columns metadata contain levels appear tree. plotting, ggplot2::discrete_scale normally solves drop = TRUE, however can lead inconsistencies sharing scale across multiple phylepic panels. phylepic() drops unused levels factors scales can use drop = FALSE consistency.","code":""},{"path":"https://cidm-ph.github.io/phylepic/reference/phylepic.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Combine metadata (a line list) with a phylogenetic tree — phylepic","text":"","code":"library(ape)  tree <- read.tree(system.file(\"enteric.newick\", package = \"phylepic\")) metadata <- read.csv(   system.file(\"enteric_metadata.csv\", package = \"phylepic\") ) phylepic(tree, metadata, name, as.Date(collection_date)) #> Dated phylogenetic tree with 50 tips, and their associated metadata. #>  #> Tip labels: \"NSW-0356\" \"NSW-0333\" \"NSW-0054\" \"NSW-0287\" \"NSW-0095\" ... #>  #> Date values: as.Date(collection_date) #>  #> Metadata 'data.frame':\t50 obs. of  4 variables: #>  $ name           : chr  \"NSW-0004\" \"NSW-0020\" \"NSW-0029\" \"NSW-0042\" ... #>  $ collection_date: chr  \"2013-02-18\" \"2016-11-19\" \"2017-01-13\" \"2017-02-28\" ... #>  $ source         : chr  NA NA NA NA ... #>  $ cluster        : chr  NA NA NA NA ..."},{"path":"https://cidm-ph.github.io/phylepic/reference/plot.phylepic.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot ","title":"Plot ","text":"autoplot plot methods \"phylepic\" objects assemble various panels final plot. facilitate customisations, plots panel can overwritten. effort made ensure specified plots look reasonable assembled.","code":""},{"path":"https://cidm-ph.github.io/phylepic/reference/plot.phylepic.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot ","text":"","code":"# S3 method for phylepic plot(x, ...)  # S3 method for phylepic autoplot(   object,   ...,   plot.tree = plot_tree(),   plot.bars = plot_bars(),   plot.calendar = plot_calendar(),   plot.epicurve = plot_epicurve(),   scale.date = NULL,   scale.fill = NULL,   width.tree = 10,   width.bars = 1,   width.date = 5,   width.legend = 2,   height.tree = 2 )"},{"path":"https://cidm-ph.github.io/phylepic/reference/plot.phylepic.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot ","text":"... Arguments passed autoplot.phylepic   object, x Object class \"phylepic\". plot.tree ggplot tree panel (see plot_tree). plot.bars ggplot metadata bars panel (see plot_bars). plot.calendar ggplot calendar panel (see plot_calendar). plot.epicurve ggplot epidemic curve panel (see plot_epicurve). scale.date date scale passed calendar epicurve panels (see ggplot2::scale_x_date). scale.fill fill scale passed calendar epicurve panels (see ggplot2::scale_x_date). width.tree Relative width tree panel. width.bars Relative width metadata bars panel. width.date Relative width calendar panel. width.legend Relative width legend, present. height.tree Relative height tree panel.","code":""},{"path":"https://cidm-ph.github.io/phylepic/reference/plot.phylepic.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Plot ","text":"general, wish suppress panel plot, set corresponding plot.* argument NULL. customise , use corresponding plot_*() function, returns ggplot plot. can add new layers themes plot. See vignette(\"phylepic\") examples. Legends panels collected de-duplicated. drawn right edge overall plot.","code":""},{"path":[]},{"path":"https://cidm-ph.github.io/phylepic/reference/plot_bars.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot metadata bars panel — plot_bars","title":"Plot metadata bars panel — plot_bars","text":"uses ggplot2::geom_tile() produce grid row aligned tip tree, column type data specified. scales specified, one created factor column metadata table.","code":""},{"path":"https://cidm-ph.github.io/phylepic/reference/plot_bars.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot metadata bars panel — plot_bars","text":"","code":"plot_bars(phylepic, ...)"},{"path":"https://cidm-ph.github.io/phylepic/reference/plot_bars.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot metadata bars panel — plot_bars","text":"phylepic object class \"phylepic\". ... scale specifications.","code":""},{"path":"https://cidm-ph.github.io/phylepic/reference/plot_bars.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot metadata bars panel — plot_bars","text":"phylepic specified returns ggplot, otherwise function passed \"phylepic\" object produces ggplot use plot.phylepic().","code":""},{"path":[]},{"path":"https://cidm-ph.github.io/phylepic/reference/plot_calendar.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot calendar panel — plot_calendar","title":"Plot calendar panel — plot_calendar","text":"Plot calendar panel","code":""},{"path":"https://cidm-ph.github.io/phylepic/reference/plot_calendar.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot calendar panel — plot_calendar","text":"","code":"plot_calendar(   phylepic,   fill = NULL,   weeks = TRUE,   week_start = getOption(\"phylepic.week_start\"),   labels = NULL,   labels.params = list(size = 3, fontface = \"bold\", colour = \"white\") )"},{"path":"https://cidm-ph.github.io/phylepic/reference/plot_calendar.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot calendar panel — plot_calendar","text":"phylepic Object class \"phylepic\". fill Variable metadata table use fill aesthetic (tidy-eval). weeks TRUE, bin date axis weeks. week_start Day week begins (defaults Monday). Can specified case-insensitive English weekday name \"Monday\" integer. Since generally want mix definitions, convenient control globally \"phylepic.week_start\" option, e.g. options(phylepic.week_start = \"Monday\"). labels Controls format date labels calendar tiles. NULL, labels drawn. character scalar, controls date format (see strptime()). labels.params Passed ggplot2::geom_text() labels drawn.","code":""},{"path":"https://cidm-ph.github.io/phylepic/reference/plot_calendar.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot calendar panel — plot_calendar","text":"phylepic specified returns ggplot, otherwise function passed \"phylepic\" object produces ggplot use plot.phylepic().","code":""},{"path":[]},{"path":"https://cidm-ph.github.io/phylepic/reference/plot_epicurve.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot epidemic curve panel — plot_epicurve","title":"Plot epidemic curve panel — plot_epicurve","text":"Plot epidemic curve panel","code":""},{"path":"https://cidm-ph.github.io/phylepic/reference/plot_epicurve.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot epidemic curve panel — plot_epicurve","text":"","code":"plot_epicurve(   phylepic,   fill = NULL,   weeks = TRUE,   week_start = getOption(\"phylepic.week_start\") )"},{"path":"https://cidm-ph.github.io/phylepic/reference/plot_epicurve.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot epidemic curve panel — plot_epicurve","text":"phylepic Object class \"phylepic\". fill Variable metadata table use fill aesthetic (tidy-eval). weeks TRUE, bin date axis weeks. week_start Day week begins (defaults Monday). Can specified case-insensitive English weekday name \"Monday\" integer. Since generally want mix definitions, convenient control globally \"phylepic.week_start\" option, e.g. options(phylepic.week_start = \"Monday\").","code":""},{"path":"https://cidm-ph.github.io/phylepic/reference/plot_epicurve.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot epidemic curve panel — plot_epicurve","text":"phylepic specified returns ggplot, otherwise function passed \"phylepic\" object produces ggplot use plot.phylepic().","code":""},{"path":[]},{"path":"https://cidm-ph.github.io/phylepic/reference/plot_tree.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot phylogenetic tree panel — plot_tree","title":"Plot phylogenetic tree panel — plot_tree","text":"tree drawn using ggraph dendrogram layout. customising , may wish add layers ggraph::geom_node_point(). metadata table joined onto tree, column names available use various ggraph geoms.","code":""},{"path":"https://cidm-ph.github.io/phylepic/reference/plot_tree.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot phylogenetic tree panel — plot_tree","text":"","code":"plot_tree(phylepic, label = .data$name, bootstrap = TRUE)"},{"path":"https://cidm-ph.github.io/phylepic/reference/plot_tree.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot phylogenetic tree panel — plot_tree","text":"phylepic object class \"phylepic\". label variable metadata table corresponding tip labels (tidy-eval). bootstrap TRUE, draw bootstrap vaues tree. drawn detected node labels form \"/b\" \"\" \"b\" numbers. Currently, bootstrap values displayed percentage, suppressing zero values values short branches. customise appearance details instead use bootstrap = FALSE add layer ggraph::geom_edge_elbow.","code":""},{"path":"https://cidm-ph.github.io/phylepic/reference/plot_tree.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot phylogenetic tree panel — plot_tree","text":"phylepic specified returns ggplot, otherwise function passed \"phylepic\" object produces ggplot use plot.phylepic().","code":""},{"path":[]},{"path":"https://cidm-ph.github.io/phylepic/reference/scale_x_week.html","id":null,"dir":"Reference","previous_headings":"","what":"Date scale with breaks specified by week — scale_x_week","title":"Date scale with breaks specified by week — scale_x_week","text":"Date scale breaks specified week","code":""},{"path":"https://cidm-ph.github.io/phylepic/reference/scale_x_week.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Date scale with breaks specified by week — scale_x_week","text":"","code":"scale_x_week(   name = waiver(),   week_breaks = waiver(),   labels = waiver(),   date_labels = waiver(),   week_minor_breaks = waiver(),   oob = oob_infinite,   ...,   week_start = getOption(\"phylepic.week_start\") )"},{"path":"https://cidm-ph.github.io/phylepic/reference/scale_x_week.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Date scale with breaks specified by week — scale_x_week","text":"name, labels, date_labels, oob, ... see ggplot2::scale_x_date(). week_breaks, week_minor_breaks frequency breaks number weeks (e.g. 2 fortnightly breaks). week_start Day week begins (defaults Monday). Can specified case-insensitive English weekday name \"Monday\" integer. Since generally want mix definitions, convenient control globally \"phylepic.week_start\" option, e.g. options(phylepic.week_start = \"Monday\").","code":""},{"path":"https://cidm-ph.github.io/phylepic/reference/scale_x_week.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Date scale with breaks specified by week — scale_x_week","text":"ggplot scale object.","code":""},{"path":"https://cidm-ph.github.io/phylepic/reference/stat_week.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate week bins from dates — stat_week","title":"Calculate week bins from dates — stat_week","text":"Computes weeks date data. mostly equivalent ggplot2::stat_bin() bins fixed weeks starting particular day.","code":""},{"path":"https://cidm-ph.github.io/phylepic/reference/stat_week.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate week bins from dates — stat_week","text":"","code":"stat_week(   mapping = NULL,   data = NULL,   geom = \"bar\",   position = \"stack\",   ...,   na.rm = FALSE,   show.legend = NA,   inherit.aes = TRUE,   week_start = getOption(\"phylepic.week_start\"),   pad = FALSE )"},{"path":"https://cidm-ph.github.io/phylepic/reference/stat_week.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate week bins from dates — stat_week","text":"mapping, data, geom, position, na.rm, show.legend, inherit.aes, pad, ... See ggplot2::stat_bin(). week_start Day week begins (defaults Monday). Can specified case-insensitive English weekday name \"Monday\" integer. Since generally want mix definitions, convenient control globally \"phylepic.week_start\" option, e.g. options(phylepic.week_start = \"Monday\").","code":""},{"path":"https://cidm-ph.github.io/phylepic/reference/stat_week.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate week bins from dates — stat_week","text":"ggplot2 stat layer.","code":""},{"path":"https://cidm-ph.github.io/phylepic/reference/stat_week_2d.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate week bins with additional binning in the y axis — stat_week_2d","title":"Calculate week bins with additional binning in the y axis — stat_week_2d","text":"Computes week bins date data x aesthetic, allows binning specified y aesthetic. mostly equivalent ggplot2::stat_bin_2d() x aesthetic handling fixed weeks.","code":""},{"path":"https://cidm-ph.github.io/phylepic/reference/stat_week_2d.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate week bins with additional binning in the y axis — stat_week_2d","text":"","code":"stat_week_2d(   mapping = NULL,   data = NULL,   geom = \"tile\",   position = \"identity\",   ...,   bins.y = NULL,   binwidth.y = NULL,   breaks.y = NULL,   center.y = NULL,   boundary.y = NULL,   closed.y = c(\"left\", \"right\"),   drop = TRUE,   week_start = getOption(\"phylepic.week_start\"),   na.rm = FALSE,   show.legend = NA,   inherit.aes = TRUE )"},{"path":"https://cidm-ph.github.io/phylepic/reference/stat_week_2d.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate week bins with additional binning in the y axis — stat_week_2d","text":"mapping, data, geom, position, na.rm, show.legend, inherit.aes, ... See ggplot2::stat_bin_2d. bins.y, binwidth.y, breaks.y, center.y, boundary.y, closed.y See analogous parameters ggplot2::stat_bin_2d. drop drop bins zero count. week_start Day week begins (defaults Monday). Can specified case-insensitive English weekday name \"Monday\" integer. Since generally want mix definitions, convenient control globally \"phylepic.week_start\" option, e.g. options(phylepic.week_start = \"Monday\").","code":""},{"path":"https://cidm-ph.github.io/phylepic/reference/stat_week_2d.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate week bins with additional binning in the y axis — stat_week_2d","text":"ggplot2 stat layer.","code":""},{"path":"https://cidm-ph.github.io/phylepic/reference/week_breaks.html","id":null,"dir":"Reference","previous_headings":"","what":"Breaks for week-binning date axes — week_breaks","title":"Breaks for week-binning date axes — week_breaks","text":"Breaks week-binning date axes","code":""},{"path":"https://cidm-ph.github.io/phylepic/reference/week_breaks.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Breaks for week-binning date axes — week_breaks","text":"","code":"week_breaks(width = 1L, week_start = getOption(\"phylepic.week_start\"))"},{"path":"https://cidm-ph.github.io/phylepic/reference/week_breaks.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Breaks for week-binning date axes — week_breaks","text":"width Number weeks breaks (e.g. 2 give break every fortnight). week_start Day week begins (defaults Monday). Can specified case-insensitive English weekday name \"Monday\" integer. Since generally want mix definitions, convenient control globally \"phylepic.week_start\" option, e.g. options(phylepic.week_start = \"Monday\").","code":""},{"path":"https://cidm-ph.github.io/phylepic/reference/week_breaks.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Breaks for week-binning date axes — week_breaks","text":"break function suitable use ggplot2::scale_x_date() et al.","code":""}]
